const List<double> h = [
  -0.000246711504948257,
  -0.000137662798279358,
  0.000000000000000002,
  0.000154357223134833,
  0.000310241083809413,
  0.000450623359671606,
  0.000558356708803054,
  0.000618101914094453,
  0.000618237096121872,
  0.000552529197963614,
  0.000421356242799353,
  0.000232301909411377,
  -0.000000000000000001,
  -0.000254819227781841,
  -0.000507043163764573,
  -0.000729525447415820,
  -0.000895862131617485,
  -0.000983324319941675,
  -0.000975637299336965,
  -0.000865288738441293,
  -0.000655075615753937,
  -0.000358660668828863,
  0.000000000000000001,
  0.000388383854671337,
  0.000768185417002402,
  0.001098936440094729,
  0.001342136175242033,
  0.001465486286496206,
  0.001446784422194818,
  0.001277035204230073,
  0.000962389972538800,
  0.000524624545722933,
  -0.000000000000000002,
  -0.000563487050761060,
  -0.001110286578392119,
  -0.001582567500842597,
  -0.001926099556883440,
  -0.002096167296875121,
  -0.002062896915576211,
  -0.001815397467123792,
  -0.001364203233215978,
  -0.000741648681679529,
  0.000000000000000002,
  0.000792609670720362,
  0.001558161972079306,
  0.002216155191643512,
  0.002691750195055933,
  0.002923864439411211,
  0.002872373458730252,
  0.002523619009378697,
  0.001893548145650640,
  0.001028009940596336,
  -0.000000000000000003,
  -0.001096056256448678,
  -0.002152581125625241,
  -0.003058995740799133,
  -0.003712824086418060,
  -0.004030675992414080,
  -0.003957982430102025,
  -0.003476415203699060,
  -0.002608093775344187,
  -0.001415953482062346,
  0.000000000000000003,
  0.001510426372813339,
  0.002967843668318832,
  0.004220365974657944,
  0.005126763496291966,
  0.005571416864997355,
  0.005477662533545528,
  0.004818096154456147,
  0.003620617029381622,
  0.001969345567132092,
  -0.000000000000000003,
  -0.002110160575808115,
  -0.004157179878645946,
  -0.005928880572631694,
  -0.007225394895659716,
  -0.007879877179982826,
  -0.007777395199045601,
  -0.006870052006589672,
  -0.005186634082249453,
  -0.002835501459232560,
  0.000000000000000004,
  0.003073661128486655,
  0.006095420062200947,
  0.008755933764690985,
  0.010754790667235897,
  0.011829998928002679,
  0.011786133970396649,
  0.010518504760281993,
  0.008030912845533514,
  0.004445022135806252,
  -0.000000000000000004,
  -0.004958118496576543,
  -0.009997016790611435,
  -0.014627424143767529,
  -0.018339161915825096,
  -0.020641218280703935,
  -0.021102700920905666,
  -0.019391312779309638,
  -0.015306072721312212,
  -0.008801362469056499,
  0.000000000000000004,
  0.010806129022544903,
  0.023168372744938569,
  0.036505995510278728,
  0.050141668409478930,
  0.063345284278118447,
  0.075382891398604379,
  0.085567071152768126,
  0.093304911865447343,
  0.098139872057622882,
  0.099784272433969923,
  0.098139872057622882,
  0.093304911865447343,
  0.085567071152768126,
  0.075382891398604379,
  0.063345284278118447,
  0.050141668409478930,
  0.036505995510278728,
  0.023168372744938569,
  0.010806129022544903,
  0.000000000000000004,
  -0.008801362469056499,
  -0.015306072721312207,
  -0.019391312779309638,
  -0.021102700920905666,
  -0.020641218280703935,
  -0.018339161915825096,
  -0.014627424143767529,
  -0.009997016790611435,
  -0.004958118496576543,
  -0.000000000000000004,
  0.004445022135806252,
  0.008030912845533514,
  0.010518504760281997,
  0.011786133970396649,
  0.011829998928002679,
  0.010754790667235893,
  0.008755933764690985,
  0.006095420062200947,
  0.003073661128486655,
  0.000000000000000004,
  -0.002835501459232561,
  -0.005186634082249453,
  -0.006870052006589672,
  -0.007777395199045601,
  -0.007879877179982826,
  -0.007225394895659716,
  -0.005928880572631696,
  -0.004157179878645947,
  -0.002110160575808114,
  -0.000000000000000003,
  0.001969345567132092,
  0.003620617029381622,
  0.004818096154456147,
  0.005477662533545528,
  0.005571416864997356,
  0.005126763496291963,
  0.004220365974657944,
  0.002967843668318832,
  0.001510426372813339,
  0.000000000000000003,
  -0.001415953482062347,
  -0.002608093775344188,
  -0.003476415203699059,
  -0.003957982430102024,
  -0.004030675992414080,
  -0.003712824086418060,
  -0.003058995740799133,
  -0.002152581125625241,
  -0.001096056256448678,
  -0.000000000000000003,
  0.001028009940596336,
  0.001893548145650640,
  0.002523619009378697,
  0.002872373458730252,
  0.002923864439411211,
  0.002691750195055935,
  0.002216155191643511,
  0.001558161972079306,
  0.000792609670720362,
  0.000000000000000002,
  -0.000741648681679529,
  -0.001364203233215978,
  -0.001815397467123793,
  -0.002062896915576211,
  -0.002096167296875121,
  -0.001926099556883440,
  -0.001582567500842597,
  -0.001110286578392119,
  -0.000563487050761060,
  -0.000000000000000002,
  0.000524624545722933,
  0.000962389972538800,
  0.001277035204230073,
  0.001446784422194818,
  0.001465486286496206,
  0.001342136175242033,
  0.001098936440094730,
  0.000768185417002401,
  0.000388383854671337,
  0.000000000000000001,
  -0.000358660668828863,
  -0.000655075615753937,
  -0.000865288738441293,
  -0.000975637299336965,
  -0.000983324319941675,
  -0.000895862131617485,
  -0.000729525447415820,
  -0.000507043163764573,
  -0.000254819227781841,
  -0.000000000000000001,
  0.000232301909411377,
  0.000421356242799353,
  0.000552529197963614,
  0.000618237096121872,
  0.000618101914094453,
  0.000558356708803054,
  0.000450623359671606,
  0.000310241083809414,
  0.000154357223134833,
  0.000000000000000002,
  -0.000137662798279358,
  -0.000246711504948257,
];

const List<double> h1 = [
  -0.000421087665445446,
  -0.000439878126871362,
  -0.000451310899134231,
  -0.000454328310916493,
  -0.000447972554874063,
  -0.000431415549676605,
  -0.000403987923114716,
  -0.000365206420780974,
  -0.000314799041276538,
  -0.000252727210203173,
  -0.000179204331789779,
  -0.000094710098983515,
  0.000000000000000000,
  0.000103890468861293,
  0.000215647288734430,
  0.000333685408440196,
  0.000456162436576835,
  0.000580998613924221,
  0.000705903018730300,
  0.000828405826532537,
  0.000945896312705204,
  0.001055666152525036,
  0.001154957442921623,
  0.001241014744980141,
  0.001311140329441147,
  0.001362751701580182,
  0.001393440389515455,
  0.001401030903576075,
  0.001383638716029715,
  0.001339726072100944,
  0.001268154426368096,
  0.001168232304498165,
  0.001039757419653362,
  0.000883051926136069,
  0.000698989769834460,
  0.000489015195228123,
  0.000255151591081480,
  -0.000000000000000001,
  -0.000273273221192171,
  -0.000560959925140330,
  -0.000858845024834924,
  -0.001162252612529140,
  -0.001466103078194227,
  -0.001764980746215773,
  -0.002053211336645717,
  -0.002324948349295289,
  -0.002574267269279742,
  -0.002795266305272826,
  -0.002982172200555696,
  -0.003129449505627876,
  -0.003231911573105644,
  -0.003284831433958055,
  -0.003284050641519875,
  -0.003226084128416846,
  -0.003108219113276484,
  -0.002928606120057752,
  -0.002686340233607526,
  -0.002381530810617110,
  -0.002015357994855556,
  -0.001590114548112298,
  -0.001109231701779253,
  -0.000577287955927634,
  0.000000000000000001,
  0.000615804801772590,
  0.001262234630497381,
  0.001930398108810786,
  0.002610487535620340,
  0.003291879810670697,
  0.003963254091088386,
  0.004612724920395217,
  0.005227989281616273,
  0.005796485755282360,
  0.006305563715374129,
  0.006742660276312785,
  0.007095482516321821,
  0.007352192350745097,
  0.007501591316540902,
  0.007533302458895724,
  0.007437946484755611,
  0.007207309367376991,
  0.006834498651315813,
  0.006314085818387462,
  0.005642232231038782,
  0.004816796368494780,
  0.003837420310432196,
  0.002705593699520021,
  0.001424693724001299,
  -0.000000000000000001,
  -0.001561316404699329,
  -0.003250230183621616,
  -0.005055925227511440,
  -0.006965883871580920,
  -0.008966001145353954,
  -0.011040722826357338,
  -0.013173205722464002,
  -0.015345498251083152,
  -0.017538739052621911,
  -0.019733371076345794,
  -0.021909368314099831,
  -0.024046472135913353,
  -0.026124434005245670,
  -0.028123261223762713,
  -0.030023462278512526,
  -0.031806288339807490,
  -0.033453967486784003,
  -0.034949928319374955,
  -0.036279009749298388,
  -0.037427653946772645,
  -0.038384079651305886,
  -0.039138433330576088,
  -0.039682915986874318,
  -0.040011883760917376,
  0.959878079137453821,
  -0.040011883760917376,
  -0.039682915986874318,
  -0.039138433330576088,
  -0.038384079651305886,
  -0.037427653946772645,
  -0.036279009749298388,
  -0.034949928319374955,
  -0.033453967486784003,
  -0.031806288339807490,
  -0.030023462278512526,
  -0.028123261223762713,
  -0.026124434005245663,
  -0.024046472135913353,
  -0.021909368314099831,
  -0.019733371076345794,
  -0.017538739052621911,
  -0.015345498251083152,
  -0.013173205722464002,
  -0.011040722826357338,
  -0.008966001145353954,
  -0.006965883871580920,
  -0.005055925227511440,
  -0.003250230183621618,
  -0.001561316404699329,
  -0.000000000000000001,
  0.001424693724001298,
  0.002705593699520021,
  0.003837420310432196,
  0.004816796368494780,
  0.005642232231038782,
  0.006314085818387462,
  0.006834498651315813,
  0.007207309367376991,
  0.007437946484755611,
  0.007533302458895724,
  0.007501591316540902,
  0.007352192350745099,
  0.007095482516321825,
  0.006742660276312782,
  0.006305563715374129,
  0.005796485755282360,
  0.005227989281616273,
  0.004612724920395217,
  0.003963254091088386,
  0.003291879810670697,
  0.002610487535620337,
  0.001930398108810786,
  0.001262234630497381,
  0.000615804801772590,
  0.000000000000000001,
  -0.000577287955927634,
  -0.001109231701779254,
  -0.001590114548112297,
  -0.002015357994855556,
  -0.002381530810617110,
  -0.002686340233607526,
  -0.002928606120057752,
  -0.003108219113276484,
  -0.003226084128416846,
  -0.003284050641519875,
  -0.003284831433958055,
  -0.003231911573105644,
  -0.003129449505627876,
  -0.002982172200555696,
  -0.002795266305272826,
  -0.002574267269279744,
  -0.002324948349295288,
  -0.002053211336645717,
  -0.001764980746215773,
  -0.001466103078194227,
  -0.001162252612529140,
  -0.000858845024834924,
  -0.000560959925140331,
  -0.000273273221192171,
  -0.000000000000000001,
  0.000255151591081480,
  0.000489015195228123,
  0.000698989769834460,
  0.000883051926136069,
  0.001039757419653362,
  0.001168232304498165,
  0.001268154426368096,
  0.001339726072100944,
  0.001383638716029715,
  0.001401030903576075,
  0.001393440389515455,
  0.001362751701580182,
  0.001311140329441146,
  0.001241014744980141,
  0.001154957442921623,
  0.001055666152525036,
  0.000945896312705204,
  0.000828405826532537,
  0.000705903018730300,
  0.000580998613924221,
  0.000456162436576835,
  0.000333685408440196,
  0.000215647288734430,
  0.000103890468861293,
  0.000000000000000000,
  -0.000094710098983515,
  -0.000179204331789778,
  -0.000252727210203173,
  -0.000314799041276538,
  -0.000365206420780974,
  -0.000403987923114716,
  -0.000431415549676606,
  -0.000447972554874063,
  -0.000454328310916492,
  -0.000451310899134230,
  -0.000439878126871362,
  -0.000421087665445446,
];
List<double> lowpassFilter2K(List<double> X) {
  List<double> result = List.filled(X.length + h.length - 1, 0.0);
  for (var i = 0; i < X.length; i++) {
    for (var j = 0; j < h.length; j++) {
      result[i + j] += X[i] * h[j];
    }
  }

  return result;
}

List<double> bandpassFilter40(List<double> X) {
  List<double> result = List.filled(X.length + h1.length - 1, 0.0);
  for (var i = 0; i < X.length; i++) {
    for (var j = 0; j < h1.length; j++) {
      result[i + j] += X[i] * h1[j];
    }
  }

  return result;
}

List<double> downsample(List<double> X, int factor) {
  List<double> result = [];
  for (var i = 0; i < X.length; i++) {
    if (i % factor == 0) result.add(X[i]);
  }
  return result;
}
